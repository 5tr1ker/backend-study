[ 아키텍쳐 ]
MySQL 서버는 크게 MySQL 서버와 스토리지 엔진으로 구분할 수 있다.
# MySQL 서버에는 두뇌 역할을 하는 MySQL 서버와 팔 다리 역할을 하는 스토리지 엔진이 있다.
# 여기서 스토리지 엔진은 핸들러 API를 만족하면 쉽게 스토리지 엔진을 구현해서 MySQL 서버에 추가해 사용할 수 있다.

- MySQL 서버
MySQL 엔진은 클라이언트의 접속 및 쿼리 요청을 처리하는 커넥션 핸들러 , SQL 파서 , 전처리기와 쿼리의 최적화된 실행을 위한 옵티마이저가 중심을 이룬다.
즉, 요청된 SQL 문장을 분석하거나 최적화하는 등 DBMS의 두뇌역할을 수행한다.

- 스토리지 엔진
실제 데이터를 디스크 스토리지에서 저장하거나 가져오는 역할을 한다. MySQL 서버에서는 하나의 MySQL 엔진에는 여러개의 스토리지 엔진이 존재할 수 있다.

아래 쿼리와 같이 테이블이 사용할 스토리지 엔진을 지정하면 이후 해당 테이블에 해당하는 데이터를 읽거나 저장할 때 해당 스토리지 엔진이 처리된다.
CREATE TABLE test_table (fd1 INT, fd2 INT) ENGINE=INNODB;

즉, CRUD 작업은 innoDB 라는 스토리지 엔진이 처리한다. 각 스토리지 엔진은 성능 향상을 위해 각자의 기능을 갖추고 있다.
# MyISAM 스토리지 엔진은 키 캐시 , innoDB 는 버서 풀 기능을 가지고 있다.

- 핸들러 API
MySQL 엔진의 쿼리 실행기에서 데이터를 쓰거나 읽을 때 각 스토리지 엔진에 쓰기 또는 읽기 작업을 요청하는데 이를 핸들러 요청이라 한다.
그리고 핸들러 요청에서 사용되는 API를 핸들러 API 라고 한다.

스토리지 엔진은 핸들러 API를 활용하여 MySQL 엔진과 데이터를 주고 받는다.

[ MySQL 스레딩 구조 ]
MySQL 서버는 프로세스 기반이 아니라 쓰레드 기반으로 동작하며 크게 포어그라운드 쓰레드와 백그라운드 쓰레드로 나뉜다.

- 포그라운드 스레드 ( 클라이언트 스레드 )
포그라운드 스레드는 MySQL 서버에 접속한 클라이언트의 수만큼 존재하고, 주로 각 클라이언트가 요청하는 쿼리 문장을 처리한다.
클라이언트가 커넥션을 끊으면 해당 커넥션을 담당하는 스레드는 스레드 캐시로 되돌아 간다.
이때 스레드 캐시에 일정 갯수 이상의 대기 중인 스레드가 있으면 해당 스레드는 종료시킨다.

포그라운드 스레드는 데이터를 버퍼나 캐시로부터 가져오며, 버퍼나 캐시에 없는 경우 디스크나 인덱스에서 데이터를 가져와 처리한다.
MyISAM 은 데이터를 디스크에 쓰는 작업도 포그라운드 슬레드가 담당하지만 InnoDB 테이블은 해당 작업을 백그라운드 스레드가 담당한다.

- 백그라운드 스레드
MyISAM 은 해당되지 않지만 InnoDB는 로드 스레드와 버퍼의 데이터를 디스크로 내려쓰는 작업을 하는 등 중요한 작업을 한다.
데이터 읽기 작업은 클라이언트 쓰레드에서 처리되기 때문에 많이 설정할 필요는 없지만 백그라운드 쓰레드는 많은 작업을 백그라운드로 처리하기 때문에 충분히 설정해주어야 한다.

읽기 작업 같은 경우 지연을 할 수 없지만, 쓰기 작업 같은 경우는 지연되어 처리할 수 있다.
그래서 InnoDB를 포함하여 대부분의 RDMS는 쓰기 작업을 지연시켜서 일괄 처리하는 기능을 가지고 있다. ( 예약을 걸어놓고 나중에 처리하는 방식 )
그렇기 때문에 InnoDB 는 CUD 쿼리로 데이터를 완전히 처리되기까지 기다리지 않아도 된다.

하지만 MyISAM 은 쓰기 버퍼링 기능을 사용할 수 없다. ( 클라이언트 쓰레드로 모두 처리하기 떄문에 읽고 쓰는 작업을 함께 처리해야 한다. )

[ 메모리 할당 및 사용 구조 ]
MySQL 에서 사용되는 메모리 공간은 크게 글로벌 메모리 공간과 로컬 메모리 공간으로 구분된다.
글로벌 메모리 영역은 MySQL 서버가 시작하면서 운영체제로 부터 할당된다. ( 운영체제 종류에 따라 100% 할당에 줄수도 있고 부분만 할당해줄 수도 있다. )

글로벌 메모리 영역과 로컬 메모리 영역은 MySQL 서버 내에 있는 많은 쓰레드가 공유해서 사용하는 공간이지 여부에 따라 구분된다.

- 글로벌 메모리 영역
일반적으로 클라이언트 쓰레드의 수와는 무관하게 하나 이상의 메모리 공간이 할당된다.
글로벌 메모리 영역이 여러개라 하더라도 모든 쓰레드에 의해 공유된다. ( 백그라운드 , 포그라운드 )

- 로컬 메모리 영역
세션 메모리 영역이라고도 하며 MySQL 서버에 존재하는 클라이안트 쓰레드가 쿼리를 처리하는데 사용하는 메모리 공간이다.
클라이언트와 MySQL 서버간에 커넥션을 세션이라고 하기 때문에 세션 메모리 영역이라고 한다.
클라이언트가 MySQL 서버에 접속하면 MySQL 서버는 클라이언트 커넥션으로부터 요청을 처리하기 위해 쓰레드를 할당한다.

로컬 메모리 영역은 각 클라이언트 쓰레드 간에 독립적으로 분리되어 있고, 공유되지 않는다.
